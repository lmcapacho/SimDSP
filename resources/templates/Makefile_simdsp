##################################################
# SimDSP Makefile
# Do not edit this file manually
##################################################

CC = gcc
CXX = g++
INCPATH =
LIBPATH =
LIBS =

SRCS 	= $(wildcard *.cpp)
OBJS 	= $(addprefix build/,$(subst .cpp,.o,$(SRCS)))

ifeq ($(OS),Windows_NT)
    CXXFLAGS 	= -O3 -Wall -std=c++11
    LDFLAGS		= -shared
    TARGET_LIB 	= build/libsdcode.dll
else
    CXXFLAGS 	= -O3 -Wall -fPIC -fvisibility=hidden -std=c++11
    LDFLAGS		= -shared -fvisibility=hidden
    TARGET_LIB 	= build/libsdcode.so
endif

.PHONY: all
all: $(TARGET_LIB)

$(TARGET_LIB): $(OBJS)
	$(CXX) $(LDFLAGS) $^ -o $@ $(LIBPATH) $(LIBS) -lsdcore

build/%.o:%.cpp
	$(CXX) $(INCPATH) $(CXXFLAGS) -c $< -o $@

.PHONY: clean
clean:
ifeq ($(OS),Windows_NT)
	rmdir /S build
else
	rm -rf build
endif
